/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see legal.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[5],{346:function(ha,ca,f){function ba(e,f,r){f.endsWith("/")||(f+="/");r=r||{};var n=r.disableWebsockets||!1;this.gO=r.singleServerMode||!1;f.endsWith("blackbox/")||(f+="blackbox/");this.Jl=r.uploadData||null;this.Lt=r.uriData||null;this.eI=r.cacheKey||null;this.Nf=Object(h.a)(f,null,n);this.Bf=f;this.TA=e;this.Xe=null;this.Yj=da();this.sm=da();this.Gv=!1;this.Kf=this.Nd=this.ae=this.He=null;this.df=[];this.kw=[];this.cache={};this.timeStamp=
0;this.yf=[];this.Cg=[];this.hB=null;this.MA=!1;this.JD=this.id=null;this.HC=this.ZK=fa;this.$x=0;this.aC=!1;this.d_=1;this.qx={};this.Nw=null;this.Rp(!0)}function da(){var e={promise:null,resolve:null,reject:null,state:0,result:null,request:null,cn:function(){return 1===(e.state&1)},mZ:function(){return 2===(e.state&2)},oh:function(){return!e.mZ()&&!e.cn()},ZY:function(){return 4===(e.state&4)},AN:function(){e.state|=4}};e.promise=new Promise(function(f,h){e.resolve=function(){if(0===e.state||4===
e.state)e.state=1,e.result=arguments[0],f.apply(null,arguments)};e.reject=function(){if(0===e.state||4===e.state)e.state=2,h.apply(null,arguments)}});return e}function fa(){return!1}function aa(e,f,h){if(!(f in x))return!0;f=x[f];for(var n=0;n<f.length;n++){var r=e;var w=f[n];var y=h;if(w.name in r){var aa="",ba=!1;r=r[w.name];switch(w.type){case "s":aa="String";ba=Object(z.isString)(r);break;case "a":aa="Array";ba=Object(z.isArray)(r);break;case "n":aa="Number";ba=Object(z.isNumber)(r)&&Object(z.isFinite)(r);
break;case "o":aa="Object",ba=Object(z.isObject)(r)&&!Object(z.isArray)(r)}ba||y.reject('Expected response field "'+w.name+'" to have type '+aa);w=ba}else y.reject('Response missing field "'+w.name+'"'),w=!1;if(!w)return!1}return!0}f.r(ca);var z=f(0);f.n(z);var y=f(1);ha=f(35);var w=f(26),h=f(363),r=f(74);f=f(290);var x={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",
type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}]};ba.prototype=Object(z.extend)(ba.prototype,{sU:function(){var e=this;return new Promise(function(f,h){var n=new XMLHttpRequest;n.open("GET",e.Bf+"ck");n.withCredentials=e.Pm();n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?f():h())};
n.send()})},A1:function(e,f){this.ZK=e||fa;this.HC=f||fa},tI:function(){var e=this;this.sm=da();this.Yj=da();return this.Nf.cB().then(function(){e.Gv=!1;e.id=null;e.MA=!1;return e.sU()})},xD:function(){this.ZK();this.$w();this.He&&(this.He.oh()?this.Ye(this.He.request):this.He.cn()&&this.HC(this.He.result.url,"pdf")&&(this.He=null,this.ZM()));this.Kf&&this.Kf.oh()&&this.Ye(this.Kf.request);this.ae&&this.ae.oh()?this.Ye(this.ae.request):this.Nd&&this.Nd.oh()&&this.NK(this.Nd.request);var e;for(e=0;e<
this.yf.length;e++)this.yf[e]&&this.yf[e]&&(this.yf[e].oh()?this.Ye(this.yf[e].request):this.yf[e].cn()&&this.HC(this.yf[e].result.url,"image")&&(this.yf[e]=null,this.Xx(e)));for(e=0;e<this.Cg.length;e++)this.Cg[e]&&this.Cg[e]&&this.Cg[e].oh()&&!this.Cg[e].ZY()&&this.Ye(this.Cg[e].request);for(e=0;e<this.df.length;e++)this.df[e]&&this.df[e].oh()&&this.Ye(this.df[e].request)},$w:function(){var e=this;this.Gv||(this.timeStamp=Date.now(),this.Nf.mE(function(f){e.p_(f)}).then(function(){clearInterval(e.lD);
e.lD=null},function(f){Object(y.e)("Blackbox connection failed:"+f);e.Gv=!1;if(!e.lD){var h=0;e.MA=!0;e.JD=0;e.lD=setInterval(function(){50>h++&&e.xD()},5E3)}}),this.Gv=!0)},B3:function(){var e=this,f=createPromiseCapability();if(this.Jl){var h=new FormData;h.append("file",this.Jl.fileHandle,this.Jl.fileHandle.name);var r=this.Jl.loadCallback;var x="upload";var y=this.Jl.extension}else if(this.Lt){h={uri:this.Lt.uri,G6:this.Lt.shareId};h=Object.keys(h).map(function(e){return e+"="+(h[e]?encodeURIComponent(h[e]):
"")}).join("&");var z="application/x-www-form-urlencoded; charset=UTF-8";r=this.Lt.loadCallback;x="url";y=this.Lt.extension}else return Promise.resolve();var aa=new XMLHttpRequest;aa.open("POST",Object(w.i)(e.Bf,"AuxUpload?ext="+y+"&type="+x+"&bcid="+this.Nf.clientId));aa.withCredentials=this.Pm();z&&aa.setRequestHeader("Content-Type",z);aa.addEventListener("load",function(){if(aa.readyState===aa.DONE&&200===aa.status){var h=JSON.parse(aa.response);e.TA=h.uri;r(h);f.resolve(h)}});aa.addEventListener("error",
function(){f.reject(aa.statusText+" "+JSON.stringify(aa))});this.Jl&&null!=this.Jl.onProgress&&(aa.upload.onprogress=function(f){e.Jl.onProgress(f)});aa.send(h);return f.promise},Q1:function(e){this.Nw=e},aY:function(e){this.password&&this.Yj.cn()?e(this.password):this.Nw(e)},p0:function(e){this.password=e||null;this.Yj.cn()||(this.$w(),this.Ye({t:"pages"}));return this.Yj.promise},kt:function(e){this.hB=e||null;this.Yj.cn()||(this.$w(),this.Ye({t:"pages"}));return this.Yj.promise},vI:function(e){e=
Object.assign(e,{uri:encodeURIComponent(this.TA)});this.hB&&(e.ext=this.hB);this.Xe&&(e.c=this.Xe);this.password&&(e.pswd=this.password);this.eI&&(e.cacheKey=this.eI);return e},Ye:function(e){e=this.vI(e);this.Nf.send(e)},tj:function(e){return e},p_:function(e){var f=this,h=e.data,w=e.err,x=e.t;if(w&&f.Nw&&"This document could not be decrypted with the given password"===w)f.Nw(function(e){f.p0(e)});else switch(x){case "upload":w?f.C3.reject(w):f.C3.resolve("Success");break;case "pages":w?f.Yj.reject(w):
aa(h,x,f.Yj)&&f.Yj.resolve(h);break;case "config":w?f.sm.reject(w):aa(h,x,f.sm)&&(h.id&&(f.id=h.id),h.serverVersion&&(f.Q3=h.serverVersion,Object(y.f)("[WebViewer Server] server version: "+f.Q3)),h.serverID?(f.$x=h.serverID===f.JD&&f.aC?f.$x+1:0,f.JD=h.serverID):f.$x=0,f.aC=!1,f.sm.resolve(h));break;case "health":w?f.sm.reject(w):aa(h,x,f.sm)&&(e=h.unhealthy,this.gO&&(e=h.isDead),!f.m5&&e&&1>=f.$x&&(f.aC=!0,f.tI().then(function(){f.xD()},function(){f.xD()})));break;case "pdf":h.url=f.Bf+"../"+encodeURI(h.url)+
"?bcid="+this.Nf.clientId;w?f.He.reject(w):aa(h,x,f.He)&&f.He.resolve(h);break;case "docmod":h.url=f.Bf+"../"+encodeURI(h.url)+"?bcid="+this.Nf.clientId;w?f.qx[h.rID].reject(w):aa(h,x,f.He)&&f.qx[h.rID].resolve(h);break;case "xod":if(w)this.ae&&this.ae.oh()&&this.ae.reject(w),this.Nd&&this.Nd.oh()&&this.Nd.reject(w);else if(h.notFound)h.noCreate||this.ae&&this.ae.oh()&&this.ae.resolve(h),this.Nd&&this.Nd.oh()&&this.Nd.resolve(h);else{h.url&&(h.url=f.Bf+"../"+encodeURI(h.url)+"?bcid="+this.Nf.clientId);
if(!this.Nd||this.Nd.cn())this.Nd=da(),this.Nd.request={t:"xod",noCreate:!0};this.ae||(this.ae=da(),this.ae.request={t:"xod"});this.Nd.resolve(h);this.ae.resolve(h)}break;case "annots":if(w)f.Kf.reject(w);else if(aa(h,x,f.Kf)){f.Kf.AN();var z=new XMLHttpRequest;e=f.Bf+"../"+encodeURI(h.url);var ba=h.hasAppearance?e+".xodapp?bcid="+this.Nf.clientId:null;e+="?bcid="+this.Nf.clientId;z.open("GET",e);z.responseType="text";z.withCredentials=this.Pm();z.addEventListener("load",function(){z.readyState===
z.DONE&&200===z.status&&f.Kf.resolve({FE:z.response,SH:ba})});z.addEventListener("error",function(){f.Kf.reject(z.statusText+" "+JSON.stringify(z))});z.send()}break;case "image":var ca=this.yf[h.p];w?ca.promise.reject(w):aa(h,x,ca)&&(ca.result=h,ca.result.url=f.Bf+"../"+encodeURI(ca.result.url)+"?bcid="+this.Nf.clientId,ca.resolve(ca.result));break;case "tiles":ca=h.rID;e=this.df[ca];this.df[ca]=null;this.kw.push(ca);if(w)e.reject(w);else if(aa(h,x,e)){for(w=0;w<h.tiles.length;w++)h.tiles[w]=f.Bf+
"../"+encodeURI(h.tiles[w])+"?bcid="+this.Nf.clientId;e.resolve(h)}break;case "text":ca=this.Cg[h.p];if(w)ca.reject(w);else if(aa(h,x,ca)){ca.AN();var fa=new XMLHttpRequest;fa.open("GET",f.Bf+"../"+encodeURI(h.url)+"?bcid="+this.Nf.clientId);fa.withCredentials=this.Pm();fa.addEventListener("load",function(){fa.readyState===fa.DONE&&200===fa.status&&(ca.result=JSON.parse(fa.response),ca.resolve(ca.result))});fa.addEventListener("error",function(e){ca.reject(fa.statusText+" "+JSON.stringify(e))});fa.send()}break;
case "progress":"loading"===h.t&&f.trigger(r.a.Events.DOCUMENT_LOADING_PROGRESS,[h.bytes,h.total])}},RJ:function(){this.$w();return this.sm.promise},qW:function(){this.Kf||(this.Kf=da(),this.Kf.request={t:"annots"},this.Ye(this.Kf.request));return this.Kf.promise},Xx:function(e){this.yf[e]||(this.yf[e]=da(),this.yf[e].request={t:"image",p:e},this.Ye(this.yf[e].request));return this.yf[e].promise},q0:function(e){this.Cg[e]||(this.Cg[e]=da(),this.Cg[e].request={t:"text",p:e},this.Ye(this.Cg[e].request));
return this.Cg[e].promise},r0:function(e,f,h,r){var n=this.df.length;this.kw.length&&(n=this.kw.pop());this.df[n]=da();this.df[n].request={t:"tiles",p:e,z:f,r:h,size:r,rID:n};this.Ye(this.df[n].request);return this.df[n].promise},ZM:function(){this.He||(this.He=da(),this.He.request={t:"pdf"},this.MA?this.He.resolve({url:this.TA}):this.Ye(this.He.request));return this.He.promise},hK:function(e){var f=this,h=new XMLHttpRequest,r=this.Bf+"aul?id="+this.id+"&bcid="+this.Nf.clientId,w=new FormData,x={};
e.annots&&(x.annots="xfdf");e.watermark&&(x.watermark="png");e.redactions&&(x.redactions="redact");x={t:"docmod",reqID:this.d_++,parts:x};e.print&&(x.print=!0);var y=this.vI(x);w.append("msg",JSON.stringify(y));return Promise.all([e.annots,e.watermark,e.redactions].map(function(e){return Promise.resolve(e)})).then(function(e){var n=e[0],x=e[1],z=e[2];n&&w.append("annots",n);x&&w.append("watermark",e.watermark);z&&w.append("redactions",z);f.qx[y.reqID]=da();h.open("POST",r);h.withCredentials=f.Pm;
h.send(w);return f.qx[y.reqID].promise})},NK:function(){this.Nd||(this.Nd=da(),this.Nd.request={t:"xod",noCreate:!0},this.Ye(this.Nd.request));return this.Nd.promise},s0:function(){this.ae||(this.ae=da(),this.ae.request={t:"xod"},this.Ye(this.ae.request));return this.ae.promise},wl:function(){return!0},request:function(){},IM:function(){},abort:function(){for(var e=0;e<this.df.length;e++)this.df[e]&&(this.df[e].resolve(null),this.df[e]=null,this.kw.push(e));this.close()},gy:function(e){this.Xe=this.Xe||
{};this.Xe.headers=e},I5:function(){return this.Xe?Object(z.omit)(this.Xe.headers,["Cookie","cookie"]):null},Rp:function(e){this.Xe=this.Xe||{};this.Xe.internal=this.Xe.internal||{};this.Xe.internal.withCredentials=e},Pm:function(){return this.Xe&&this.Xe.internal?this.Xe.internal.withCredentials:null},getFileData:function(){return Promise.reject()}});Object(ha.b)(ba);Object(f.a)(ba);Object(f.b)(ba);ca["default"]=ba},363:function(ha,ca,f){function ba(f){for(var z="",y=0;y<f;y++)z+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*
Math.random()));return z}function da(f,z,y){function w(f,e,h){function n(e){w().then(function(f){ca&&!da?setTimeout(function(){n(e)},1):f.send(JSON.stringify(e))})}function r(e,f,r){var w=window.createPromiseCapability(),ea=!1,ia=w;z=e;aa=f;ba=r;y=null;try{e=fa?ha+"/"+fa:ha+"/ws";e+="?bcid="+h;var ja=new WebSocket(e);ja.onopen=function(){w.resolve();ea=!0;w=null;ca=!1;x.resolve(ja);aa&&aa()};ja.onerror=function(e){ca=da=!0;w&&w.reject(e);y&&y.reject()};ja.onclose=function(){x=window.createPromiseCapability();
ca=!0;y||(y=window.createPromiseCapability());y.resolve();ba&&ba();z&&ea&&z({t:"health",data:{unhealthy:!0,isDead:!0}})};ja.onmessage=function(e){e&&e.data&&(e=JSON.parse(e.data),e.hb?n({hb:!0}):e.end?close():z(e))}}catch(Ba){w.reject(Ba),w=null}return ia.promise}function w(){ca&&z&&r(z);return x.promise}var x=window.createPromiseCapability(),y=null,z,aa,ba=null,ca=!1,da=!1,fa=e,ha=function(e){var f=e.indexOf("://"),h="ws://";0>f?f=0:(5===f&&(h="wss://"),f+=3);var n=e.lastIndexOf("/");0>n&&(n=e.length);
return h+e.slice(f,n)}(f);return{send:n,mE:r,cB:function(){return y?y.promise:w().then(function(e){y=window.createPromiseCapability();z=null;e.close();return y.promise})},clientId:h}}function h(f){var e=f.lastIndexOf("/");0>e&&(e=f.length);return f.slice(0,e)}var r=ba(8);return window.WebSocket&&!y?w(f,z,r):function(f,e,n){function r(e){(ca?ca.promise:Promise.resolve(ba)).then(function(f){var h=new XMLHttpRequest;f=aa?z+"/"+aa+"pf?id="+f:z+"/pf?id="+f;f+="&bcid="+n;var r=new FormData;r.append("data",
JSON.stringify(e));h.open("POST",f);h.withCredentials=!0;h.send(r)})}function w(){ba=0;ca||(ca=window.createPromiseCapability())}function x(){y=new XMLHttpRequest;var e=z+"/pf";e=0!==ba?e+("?id="+ba+"&uc="+ja):e+("?uc="+ja);ja++;y.open("GET",e,!0);y.withCredentials=!0;y.setRequestHeader("Cache-Control","no-cache");y.setRequestHeader("X-Requested-With","XMLHttpRequest");var f=y,h=!1;y.onreadystatechange=function(){a:if(3<=f.readyState&&!h){try{var e=f.responseText.length}catch(za){Object(fa.f)("caught exception");
break a}if(0<e)try{var n=f.responseText.split("\n");for(n[n.length-1]&&n.pop();0<n.length&&3>n[n.length-1].length;)"]"===n.pop()&&w();0<n.length&&3>n[0].length&&n.shift();for(e=0;e<n.length;++e)n[e].endsWith(",")&&(n[e]=n[e].substr(0,n[e].length-1));0===ba&&0<n.length&&(ba=JSON.parse(n.shift()).id,e=ca,ca=null,e.resolve(ba));var y;for(e=0;e<n.length;++e)(y=JSON.parse(n[e]))&&y.end?close():y&&y.hb&&y.id===ba?r({hb:!0}):Aa(y)}catch(za){}da||(h=!0,x())}};y.send()}var y,z=h(f),aa=e,ba=0,ca=window.createPromiseCapability(),
da=!1,ha=null,Aa=null,ja=0;return{send:r,mE:function(e,f,h){Aa=e;ha=h;da=!1;w();x();f&&f();return Promise.resolve()},cB:function(){w();Aa=null;da=!0;ha&&ha();y.abort();return Promise.resolve()},clientId:n}}(f,z,r)}f.d(ca,"a",function(){return da});var fa=f(1)}}]);}).call(this || window)
